<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Calculate and perform best normalizing transformation — bestNormalize • bestNormalize</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Calculate and perform best normalizing transformation — bestNormalize" />
<meta property="og:description" content="Performs a suite of normalizing transformations, and selects the
  best one on the basis of the Pearson P test statistic for normality. The
  transformation that has the lowest P (calculated on the transformed data)
  is selected. See details for more information." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bestNormalize</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.6.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/bestNormalize.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/customization.html">Customization within bestNormalize</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/petersonR/bestNormalize/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate and perform best normalizing transformation</h1>
    <small class="dont-index">Source: <a href='https://github.com/petersonR/bestNormalize/blob/master/R/bestNormalize.R'><code>R/bestNormalize.R</code></a></small>
    <div class="hidden name"><code>bestNormalize.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Performs a suite of normalizing transformations, and selects the
  best one on the basis of the Pearson P test statistic for normality. The
  transformation that has the lowest P (calculated on the transformed data)
  is selected. See details for more information.</p>
    </div>

    <pre class="usage"><span class='fu'>bestNormalize</span><span class='op'>(</span>
  <span class='va'>x</span>,
  standardize <span class='op'>=</span> <span class='cn'>TRUE</span>,
  allow_orderNorm <span class='op'>=</span> <span class='cn'>TRUE</span>,
  allow_lambert_s <span class='op'>=</span> <span class='cn'>FALSE</span>,
  allow_lambert_h <span class='op'>=</span> <span class='cn'>FALSE</span>,
  allow_exp <span class='op'>=</span> <span class='cn'>TRUE</span>,
  out_of_sample <span class='op'>=</span> <span class='cn'>TRUE</span>,
  cluster <span class='op'>=</span> <span class='cn'>NULL</span>,
  k <span class='op'>=</span> <span class='fl'>10</span>,
  r <span class='op'>=</span> <span class='fl'>5</span>,
  loo <span class='op'>=</span> <span class='cn'>FALSE</span>,
  warn <span class='op'>=</span> <span class='cn'>FALSE</span>,
  quiet <span class='op'>=</span> <span class='cn'>FALSE</span>,
  tr_opts <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  new_transforms <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span>,
  norm_stat_fn <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S3 method for bestNormalize</span>
<span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>object</span>, newdata <span class='op'>=</span> <span class='cn'>NULL</span>, inverse <span class='op'>=</span> <span class='cn'>FALSE</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for bestNormalize</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for bestNormalize</span>
<span class='fu'>tidy</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A `bestNormalize` object.</p></td>
    </tr>
    <tr>
      <th>standardize</th>
      <td><p>If TRUE, the transformed values are also centered and
scaled, such that the transformation attempts a standard normal. This will
not change the normality statistic.</p></td>
    </tr>
    <tr>
      <th>allow_orderNorm</th>
      <td><p>set to FALSE if orderNorm should not be applied</p></td>
    </tr>
    <tr>
      <th>allow_lambert_s</th>
      <td><p>Set to FALSE if the lambertW of type "s"  should not be
applied (see details). Expect about 2-3x elapsed computing time if TRUE.</p></td>
    </tr>
    <tr>
      <th>allow_lambert_h</th>
      <td><p>Set to TRUE if the lambertW of type "h"  should be
applied (see details). Expect about 2-3x elapsed computing time.</p></td>
    </tr>
    <tr>
      <th>allow_exp</th>
      <td><p>Set to TRUE if the exponential transformation should be
applied (sometimes this will cause errors with heavy right skew)</p></td>
    </tr>
    <tr>
      <th>out_of_sample</th>
      <td><p>if FALSE, estimates quickly in-sample performance</p></td>
    </tr>
    <tr>
      <th>cluster</th>
      <td><p>name of cluster set using <code>makeCluster</code></p></td>
    </tr>
    <tr>
      <th>k</th>
      <td><p>number of folds</p></td>
    </tr>
    <tr>
      <th>r</th>
      <td><p>number of repeats</p></td>
    </tr>
    <tr>
      <th>loo</th>
      <td><p>should leave-one-out CV be used instead of repeated CV? (see
details)</p></td>
    </tr>
    <tr>
      <th>warn</th>
      <td><p>Should bestNormalize warn when a method doesn't work?</p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p>Should a progress-bar not be displayed for cross-validation
progress?</p></td>
    </tr>
    <tr>
      <th>tr_opts</th>
      <td><p>a list (of lists), specifying options to be passed to each
transformation (see details)</p></td>
    </tr>
    <tr>
      <th>new_transforms</th>
      <td><p>a named list of new transformation functions and their
predict methods (see details)</p></td>
    </tr>
    <tr>
      <th>norm_stat_fn</th>
      <td><p>if specified, a function to calculate to assess normality
(default is the pearson chi-squared statistic divided by its d.f.)</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments.</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>an object of class 'bestNormalize'</p></td>
    </tr>
    <tr>
      <th>newdata</th>
      <td><p>a vector of data to be (reverse) transformed</p></td>
    </tr>
    <tr>
      <th>inverse</th>
      <td><p>if TRUE, performs reverse transformation</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of class <code>bestNormalize</code> with elements</p>
<p></p>
<dt>x.t</dt><dd><p>transformed original data</p></dd> <dt>x</dt><dd><p>original data</p></dd>
  <dt>norm_stats</dt><dd><p>Pearson's Pearson's P / degrees of freedom</p></dd>
  <dt>method</dt><dd><p>out-of-sample or in-sample, number of folds + repeats</p></dd>
  <dt>chosen_transform</dt><dd><p>the chosen transformation (of appropriate class)</p></dd>
  <dt>other_transforms</dt><dd><p>the other transformations (of appropriate class)</p></dd>
  <dt>oos_preds</dt><dd><p>Out-of-sample predictions (if loo == TRUE) or
  normalization stats</p></dd>

  The predict function returns the numeric value of the transformation
  performed on new data, and allows for the inverse transformation as well.

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>bestNormalize</code> estimates the optimal normalizing
  transformation. This transformation can be performed on new data, and
  inverted, via the <code>predict</code> function.</p>
<p>This function currently estimates the Yeo-Johnson transformation,
  the Box Cox transformation (if the data is positive), the log_10(x+a)
  transformation, the square-root (x+a) transformation, and the arcsinh
  transformation. a is set to max(0, -min(x) + eps) by default.  If
  allow_orderNorm == TRUE and if out_of_sample == FALSE then the ordered
  quantile normalization technique will likely be chosen since it essentially
  forces the data to follow a normal distribution. More information on the
  orderNorm technique can be found in the package vignette, or using
  <code><a href='orderNorm.html'>?orderNorm</a></code>.</p>

<p>Repeated cross-validation is used by default to estimate the out-of-sample
  performance of each transformation if out_of_sample = TRUE. While this can
  take some time, users can speed it up by creating a cluster via the
  <code>parallel</code> package's <code>makeCluster</code> function, and passing the name
  of this cluster to <code>bestNormalize</code> via the cl argument. For best
  performance, we recommend the number of clusters to be set to the number of
  repeats r. Care should be taken to account for the number of observations
  per fold; to small a number and the estimated normality statistic could be
  inaccurate, or at least suffer from high variability.</p>

<p>As of version 1.3, users can use leave-one-out cross-validation as well for
  each method by setting <code>loo</code> to <code>TRUE</code>.  This will take a lot of
  time for bigger vectors, but it will have the most accurate estimate of
  normalization efficacy. Note that if this method is selected, arguments
  <code>k, r</code> are ignored. This method will still work in parallel with the
  <code>cl</code> argument.</p>

<p>Note that the Lambert transformation of type "h" can be done by setting
  allow_lambert_h = TRUE, however this can take significantly longer to run.</p>
<p>Use <code>tr_opts</code> in order to set options for each transformation. For
  instance, if you want to overide the default a selection for <code>log_x</code>,
  set <code>tr_opts$log_x = list(a = 1)</code>.</p>
<p>See the package's vignette on how to use custom functions with
  bestNormalize. All it takes is to create an S3 class and predict method for
  the new transformation and load it into the environment, then the new
  custom function (and its predict method) can be passed to bestNormalize
  with <code>new_transform</code>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='boxcox.html'>boxcox</a></code>, <code><a href='orderNorm.html'>orderNorm</a></code>,
  <code><a href='yeojohnson.html'>yeojohnson</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/GammaDist.html'>rgamma</a></span><span class='op'>(</span><span class='fl'>100</span>, <span class='fl'>1</span>, <span class='fl'>1</span><span class='op'>)</span>

<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'># With Repeated CV</span>
<span class='va'>BN_obj</span> <span class='op'>&lt;-</span> <span class='fu'>bestNormalize</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
<span class='va'>BN_obj</span>
<span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>BN_obj</span><span class='op'>)</span>
<span class='va'>x2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>BN_obj</span>, newdata <span class='op'>=</span> <span class='va'>p</span>, inverse <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>x2</span>, <span class='va'>x</span><span class='op'>)</span>
<span class='op'>}</span>


<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'># With leave-one-out CV</span>
<span class='va'>BN_obj</span> <span class='op'>&lt;-</span> <span class='fu'>bestNormalize</span><span class='op'>(</span><span class='va'>x</span>, loo <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='va'>BN_obj</span>
<span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>BN_obj</span><span class='op'>)</span>
<span class='va'>x2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>BN_obj</span>, newdata <span class='op'>=</span> <span class='va'>p</span>, inverse <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>x2</span>, <span class='va'>x</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># Without CV</span>
<span class='va'>BN_obj</span> <span class='op'>&lt;-</span> <span class='fu'>bestNormalize</span><span class='op'>(</span><span class='va'>x</span>, allow_orderNorm <span class='op'>=</span> <span class='cn'>FALSE</span>, out_of_sample <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
<span class='va'>BN_obj</span>
</div><div class='output co'>#&gt; Best Normalizing transformation with 100 Observations
#&gt;  Estimated Normality Statistics (Pearson P / df, lower =&gt; more normal):
#&gt;  - arcsinh(x): 3.468
#&gt;  - Box-Cox: 0.712
#&gt;  - Center+scale: 5.912
#&gt;  - Exp(x): 72.971
#&gt;  - Log_b(x+a): 2.246
#&gt;  - sqrt(x + a): 1.544
#&gt;  - Yeo-Johnson: 0.894
#&gt; Estimation method: In-sample
#&gt;  
#&gt; Based off these, bestNormalize chose:
#&gt; Standardized Box Cox Transformation with 100 nonmissing obs.:
#&gt;  Estimated statistics:
#&gt;  - lambda = 0.28739 
#&gt;  - mean (before standardization) = -0.2340473 
#&gt;  - sd (before standardization) = 1.022718 </div><div class='input'><span class='va'>p</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>BN_obj</span><span class='op'>)</span>
<span class='va'>x2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>BN_obj</span>, newdata <span class='op'>=</span> <span class='va'>p</span>, inverse <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>x2</span>, <span class='va'>x</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Ryan Andrew Peterson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


